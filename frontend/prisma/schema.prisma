generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model application_addresses {
  id                                  String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  application_id                      String       @db.Uuid
  is_permanent_same_as_correspondence Boolean?
  correspondence_address_line_1       String?
  correspondence_address_line_2       String?
  correspondence_city                 String?
  correspondence_district             String?
  correspondence_state                String?
  correspondence_country              String?
  correspondence_pincode              String?
  permanent_address_line_1            String?
  permanent_address_line_2            String?
  permanent_city                      String?
  permanent_district                  String?
  permanent_state                     String?
  permanent_country                   String?
  permanent_pincode                   String?
  applications                        applications @relation(fields: [application_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model application_declarations {
  id                         String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  application_id             String       @db.Uuid
  declaration_agreed         Boolean?
  declaration_applicant_name String?
  declaration_parent_name    String?
  declaration_date           DateTime?    @db.Date
  declaration_place          String?
  applications               applications @relation(fields: [application_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model application_documents {
  id                               String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  application_id                   String       @db.Uuid
  passport_photo_url               String?
  class_x_marksheet_url            String?
  class_xii_marksheet_url          String?
  graduation_marksheet_url         String?
  aadhaar_card_url                 String?
  entrance_exam_scorecard_url      String?
  work_experience_certificates_url String?
  passport_url                     String?
  applications                     applications @relation(fields: [application_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model application_family_details {
  id                    String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  application_id        String       @db.Uuid
  father_title          String?
  father_name           String?
  father_email          String?
  father_mobile         String?
  father_occupation     String?
  mother_title          String?
  mother_name           String?
  mother_email          String?
  mother_mobile         String?
  mother_occupation     String?
  guardian_title        String?
  guardian_name         String?
  guardian_email        String?
  guardian_mobile       String?
  guardian_occupation   String?
  guardian_relationship String?
  family_annual_income  String?
  applications          applications @relation(fields: [application_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model application_identifications {
  id                       String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  application_id           String       @db.Uuid
  aadhaar_number           String?
  pan_card_number          String?
  passport_number          String?
  passport_issuing_country String?
  passport_valid_upto      DateTime?    @db.Date
  applications             applications @relation(fields: [application_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model application_preferences {
  id                            String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  application_id                String       @db.Uuid
  hostel_facility_required      Boolean?
  hostel_type                   String?
  travel_accommodation_required Boolean?
  has_given_exam                Boolean?
  has_work_experience           Boolean?
  applications                  applications @relation(fields: [application_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model applications {
  id                          String                        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  lead_id                     String                        @db.Uuid
  program_discipline          String?
  program_course              String?
  title                       String?
  dob                         DateTime?                     @db.Date
  gender                      gender_enum?
  marital_status              marital_status_enum?
  category                    category_enum?
  religion                    String?
  nationality                 String?
  blood_group                 String?
  created_at                  DateTime?                     @default(now()) @db.Timestamptz(6)
  application_addresses       application_addresses[]
  application_declarations    application_declarations[]
  application_documents       application_documents[]
  application_family_details  application_family_details[]
  application_identifications application_identifications[]
  application_preferences     application_preferences[]
  leads                       leads                         @relation(fields: [lead_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model followup_comments {
  id          BigInt     @id @default(autoincrement())
  created_at  DateTime   @default(now()) @db.Timestamptz(6)
  text        String?
  followup_id String?    @db.Uuid
  created_by  String?    @db.Uuid
  partners    partners?  @relation(fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  followups   followups? @relation(fields: [followup_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model followups {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at        DateTime            @db.Timestamptz(6)
  title             String?
  lead_id           String?             @db.Uuid
  completed         Boolean?
  created_by        String?             @db.Uuid
  due_date          DateTime?           @db.Timestamptz(6)
  followup_comments followup_comments[]
  partners          partners?           @relation(fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  leads             leads?              @relation(fields: [lead_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model leads {
  id                                   String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                                 String
  email                                String             @unique
  mobile                               String             @unique
  alternate_mobile                     String?
  type                                 String
  city                                 String
  purpose                              String
  preferred_country                    String?
  status                               String
  utm_source                           String?
  utm_medium                           String?
  utm_campaign                         String?
  assigned_to                          String?            @db.Uuid
  created_at                           DateTime           @default(now()) @db.Timestamptz(6)
  created_by                           String?            @db.Uuid
  reason                               String?
  password                             String?            @default("")
  is_flagged                           Boolean            @default(false)
  applications                         applications[]
  followups                            followups[]
  partners_leads_assigned_toTopartners partners?          @relation("leads_assigned_toTopartners", fields: [assigned_to], references: [id], onDelete: NoAction, onUpdate: NoAction)
  partners_leads_created_byTopartners  partners?          @relation("leads_created_byTopartners", fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  notes                                notes[]
  offline_payments                     offline_payments[]
  timeline                             timeline[]
}

model notes {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  text       String?
  lead_id    String?   @db.Uuid
  created_by String?   @db.Uuid
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  partners   partners? @relation(fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  leads      leads?    @relation(fields: [lead_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model partners {
  id                                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  role                              String
  name                              String
  email                             String              @unique
  mobile                            String              @unique
  password                          String
  address                           String
  city                              String
  state                             String
  area                              String
  zone                              String
  remarks                           String?
  agency_name                       String?
  created_at                        DateTime            @default(now()) @db.Timestamptz(6)
  followup_comments                 followup_comments[]
  followups                         followups[]
  leads_leads_assigned_toTopartners leads[]             @relation("leads_assigned_toTopartners")
  leads_leads_created_byTopartners  leads[]             @relation("leads_created_byTopartners")
  notes                             notes[]
  offline_payments                  offline_payments[]
  timeline                          timeline[]
}

model timeline {
  id         String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id    String         @db.Uuid
  event_type timeline_event
  old_state  String?
  new_state  String?
  created_by String         @db.Uuid
  created_at DateTime       @default(now()) @db.Timestamptz(6)
  partners   partners       @relation(fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  leads      leads          @relation(fields: [lead_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([created_at(sort: Desc)], map: "idx_timeline_created_at")
  @@index([created_by], map: "idx_timeline_created_by")
  @@index([event_type], map: "idx_timeline_event_type")
  @@index([lead_id], map: "idx_timeline_lead_id")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model offline_payments {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  payment_mode String?
  currency     String
  amount       BigInt?
  payment_type String
  reference_id String?
  receiver     String?   @db.Uuid
  lead_id      String?   @db.Uuid
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  status       String?
  file         String?
  leads        leads?    @relation(fields: [lead_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  partners     partners? @relation(fields: [receiver], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

enum academic_level_enum {
  Class_Xth_SSC   @map("Class Xth/SSC")
  Class_XIIth_HSC @map("Class XIIth/HSC")
  Graduation
  Post_Graduation @map("Post Graduation")
}

enum category_enum {
  GENERAL
  OBC
  SC
  ST
  EWS
}

enum gender_enum {
  MALE
  FEMALE
  OTHER
}

enum marital_status_enum {
  SINGLE
  MARRIED
  DIVORCED
  WIDOWED
}

enum marking_scheme_enum {
  PERCENTAGE
  CGPA_OUT_OF_10 @map("CGPA OUT OF 10")
  CGPA_OUT_OF_4  @map("CGPA OUT OF 4")
}

enum result_status_enum {
  DECLARED
  AWAITED
}

enum timeline_event {
  LEAD_CREATED
  LEAD_NAME_CHANGED
  LEAD_PHONE_CHANGED
  LEAD_EMAIL_CHANGED
  LEAD_PURPOSE_CHANGED
  LEAD_OWNER_CHANGED
  LEAD_STATUS_CHANGED
  LEAD_NOTE_ADDED
  LEAD_NOTE_DELETED
  LEAD_NOTE_UPDATED
  LEAD_FOLLOWUP_ADDED
  LEAD_FOLLOWUP_DELETED
  LEAD_FOLLOWUP_UPDATED
  LEAD_FOLLOWUP_DATE_EXTENDED
  LEAD_FOLLOWUP_COMPLETED
  LEAD_FOLLOWUP_COMMENT_ADDED
  LEAD_FOLLOWUP_COMMENT_DELETED
  LEAD_FOLLOWUP_COMMENT_UPDATED
}
